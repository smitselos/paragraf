<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸº Î‘ÏÏ‡Î±Î¯Î± Î‘Î¯Î³Ï…Ï€Ï„Î¿Ï‚ - ÎšÎµÏ†Î¬Î»Î±Î¹Î¿ 2.2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #F5F5DC;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #8B4513, #DEB887);
            color: white;
            padding: 20px;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-flex {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-info {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        h1 {
            font-size: 24px;
            margin: 5px 0;
        }

        .subtitle {
            font-size: 14px;
            margin-top: 5px;
        }

        .points {
            text-align: right;
        }

        .points-label {
            font-size: 12px;
        }

        .points-value {
            font-size: 28px;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: rgba(255,255,255,0.3);
            border-radius: 10px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: #2ECC71;
            border-radius: 10px;
            transition: width 0.3s;
        }

        .navigation {
            background-color: white;
            border-bottom: 2px solid #DEB887;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-btn.active {
            background-color: #1E90FF;
            color: white;
        }

        .nav-btn:not(.active) {
            background-color: white;
            color: #2C3E50;
        }

        .nav-btn.locked {
            background-color: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        .glossary-btn {
            padding: 12px 20px;
            border-radius: 8px;
            border: 2px solid #FFD700;
            background-color: white;
            font-weight: bold;
            cursor: pointer;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .section-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .section-tab {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            background-color: #e0e0e0;
            color: #2C3E50;
        }

        .section-tab.active {
            background-color: #1E90FF;
            color: white;
        }

        .subsection {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #F5F5DC;
            border-radius: 10px;
            border-left: 4px solid #1E90FF;
        }

        .subsection h3 {
            margin-top: 0;
            color: #2C3E50;
        }

        .subsection ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .subsection li {
            margin-bottom: 8px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .grid-item {
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .grid-item-icon {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .grid-item-label {
            font-size: 12px;
            font-weight: bold;
        }

        .pyramid {
            text-align: center;
            margin: 20px 0;
        }

        .pyramid h3 {
            margin-bottom: 15px;
        }

        .pyramid-levels {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .pyramid-level {
            background-color: #DEB887;
            border: 3px solid #8B4513;
            border-radius: 8px;
            padding: 12px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .pyramid-level:hover {
            background-color: #FFD700;
            transform: scale(1.05);
        }

        .pyramid-level-name {
            font-weight: bold;
            font-size: 13px;
        }

        .pyramid-level-desc {
            font-size: 11px;
            color: #666;
        }

        .hierarchy {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .hierarchy-box {
            background-color: #F5F5DC;
            border: 3px solid #1E90FF;
            border-radius: 12px;
            padding: 15px;
            min-width: 280px;
            text-align: center;
        }

        .hierarchy-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .hierarchy-title {
            margin: 8px 0;
            color: #8B4513;
            font-size: 16px;
        }

        .hierarchy-points {
            list-style: none;
            padding: 0;
            font-size: 13px;
        }

        .hierarchy-points li {
            margin-bottom: 5px;
        }

        .hierarchy-arrow {
            text-align: center;
            font-size: 20px;
            color: #1E90FF;
            margin: 5px 0;
        }

        .info-box {
            background-color: #e3f2fd;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            margin-top: 15px;
        }

        .definition-box {
            background-color: #fff3cd;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            margin-top: 15px;
        }

        .button-group {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-prev {
            background-color: #DEB887;
            color: #2C3E50;
        }

        .btn-prev:disabled {
            background-color: #e0e0e0;
            cursor: not-allowed;
        }

        .btn-next {
            background-color: #2ECC71;
            color: white;
        }

        .success-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #d4edda;
            border-radius: 8px;
            text-align: center;
        }

        .success-box p {
            margin: 0;
            font-weight: bold;
        }

        .continue-btn {
            margin-top: 10px;
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            background-color: #1E90FF;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }

        .image-card {
            background-color: #F5F5DC;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            border: 3px solid #DEB887;
            text-align: center;
        }

        .image-emoji {
            font-size: 100px;
            margin-bottom: 15px;
        }

        .image-title {
            color: #8B4513;
            margin-bottom: 10px;
        }

        .image-desc {
            font-size: 14px;
            color: #666;
        }

        .parathema-box {
            margin-top: 30px;
            padding: 20px;
            background-color: #F5F5DC;
            border-radius: 12px;
            border: 3px solid #FFD700;
        }

        .parathema-text {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-style: italic;
            line-height: 1.7;
            border-left: 4px solid #1E90FF;
        }

        .keywords-box {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .keywords-flex {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0;
        }

        .keyword-btn {
            padding: 6px 14px;
            border-radius: 20px;
            border: none;
            background-color: white;
            color: #2C3E50;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .keyword-btn.highlighted {
            background-color: #FFD700;
            color: white;
        }

        .exercise-numbers {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .exercise-number {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            background-color: #e0e0e0;
            color: #2C3E50;
        }

        .exercise-number.active {
            background-color: #1E90FF;
            color: white;
        }

        .exercise-number.completed {
            background-color: #2ECC71;
            color: white;
        }

        .exercise-tag {
            padding: 5px 10px;
            background-color: #FFD700;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 20px;
        }

        .question {
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .option-btn {
            padding: 15px;
            border-radius: 10px;
            border: 3px solid #ddd;
            background-color: white;
            cursor: pointer;
            text-align: left;
            font-size: 15px;
            transition: all 0.3s;
        }

        .option-btn.selected {
            border-color: #1E90FF;
            background-color: #e3f2fd;
            font-weight: bold;
        }

        .option-btn.correct {
            border-color: #2ECC71;
            background-color: #d4edda;
        }

        .option-btn.wrong {
            border-color: #E74C3C;
            background-color: #f8d7da;
        }

        .submit-btn {
            margin-top: 15px;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            background-color: #2ECC71;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }

        .submit-btn:disabled {
            background-color: #e0e0e0;
            cursor: not-allowed;
        }

        .result-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
        }

        .result-box.correct {
            background-color: #d4edda;
        }

        .result-box.incorrect {
            background-color: #fff3cd;
        }

        .pyramid-drag {
            text-align: center;
            margin: 30px 0;
        }

        .pyramid-drag-levels {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .pyramid-slot {
            min-height: 50px;
            background-color: #F5F5DC;
            border: 3px dashed #ccc;
            border-radius: 8px;
            padding: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
        }

        .pyramid-slot.filled {
            background-color: #DEB887;
            border: 3px solid #8B4513;
        }

        .drag-items-box {
            padding: 15px;
            background-color: #F5F5DC;
            border-radius: 10px;
            margin: 20px 0;
        }

        .drag-items-flex {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .drag-item {
            padding: 10px 15px;
            background-color: #1E90FF;
            color: white;
            border-radius: 8px;
            cursor: move;
            font-weight: bold;
            font-size: 13px;
        }

        .truefalse-question {
            margin-bottom: 15px;
            padding: 15px;
            background-color: #F5F5DC;
            border-radius: 10px;
        }

        .truefalse-text {
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 14px;
        }

        .truefalse-buttons {
            display: flex;
            gap: 10px;
        }

        .truefalse-btn {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 3px solid #ddd;
            background-color: white;
            cursor: pointer;
            font-weight: bold;
        }

        .truefalse-btn.selected {
            border-color: #1E90FF;
            background-color: #e3f2fd;
        }

        .truefalse-btn.correct-answer {
            border-color: #2ECC71;
            background-color: #d4edda;
        }

        .quiz-container {
            background-color: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .quiz-emoji {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .quiz-score-box {
            background-color: #F5F5DC;
            padding: 30px;
            border-radius: 12px;
            margin: 20px 0;
            border: 4px solid #FFD700;
        }

        .quiz-score {
            font-size: 48px;
            color: #FFD700;
            margin-bottom: 15px;
        }

        .quiz-details {
            margin: 10px 0;
        }

        .quiz-question-card {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .close-btn {
            border: none;
            background: none;
            font-size: 24px;
            cursor: pointer;
            color: #E74C3C;
        }

        .glossary-item {
            margin-bottom: 15px;
            padding: 15px;
            background-color: #F5F5DC;
            border-radius: 10px;
            border-left: 4px solid #FFD700;
        }

        .glossary-term-header {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .glossary-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        .glossary-term {
            font-weight: bold;
        }

        .glossary-def {
            margin: 0;
            font-size: 14px;
        }

        footer {
            background-color: #8B4513;
            color: white;
            padding: 20px;
            text-align: center;
            margin-top: 40px;
        }

        footer p {
            margin: 5px 0;
            font-size: 13px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }

            .nav-content {
                flex-direction: column;
            }

            .section-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="header-content">
            <div class="header-flex">
                <div>
                    <div class="header-info">ÎšÎ•Î¦Î‘Î›Î‘Î™ÎŸ 2.2 | Î‘' Î›Î¥ÎšÎ•Î™ÎŸÎ¥</div>
                    <h1>ğŸº Î‘Î¡Î§Î‘Î™Î‘ Î‘Î™Î“Î¥Î Î¤ÎŸÎ£</h1>
                    <div class="subtitle">ÎŸÎ¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ®, ÎšÎ¿Î¹Î½Ï‰Î½Î¹ÎºÎ® ÎºÎ±Î¹ Î Î¿Î»Î¹Ï„Î¹ÎºÎ® ÎŸÏÎ³Î¬Î½Ï‰ÏƒÎ·</div>
                </div>
                <div class="points">
                    <div class="points-label">Î ÏŒÎ½Ï„Î¿Î¹</div>
                    <div class="points-value">ğŸ”º <span id="points">0</span></div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
        </div>
    </header>

    <!-- NAVIGATION -->
    <div class="navigation">
        <div class="nav-content">
            <button class="nav-btn active" id="navTheory" onclick="switchTab('theory')">ğŸ“š Î˜Î•Î©Î¡Î™Î‘</button>
            <button class="nav-btn locked" id="navVisual" onclick="switchTab('visual')">ğŸ”’ ğŸ–¼ï¸ ÎŸÎ Î¤Î™ÎšÎŸ</button>
            <button class="nav-btn locked" id="navExercises" onclick="switchTab('exercises')">ğŸ”’ âœï¸ Î‘Î£ÎšÎ—Î£Î•Î™Î£</button>
            <button class="glossary-btn" onclick="toggleGlossary()">ğŸ“–</button>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">
        <!-- THEORY TAB -->
        <div id="theoryTab" class="card">
            <div class="section-tabs">
                <button class="section-tab active" onclick="switchTheorySection(0)">ğŸŒ¾ Î— ÎŸÎ™ÎšÎŸÎÎŸÎœÎ™Î‘</button>
                <button class="section-tab" onclick="switchTheorySection(1)">ğŸ‘¥ Î— ÎšÎŸÎ™ÎÎ©ÎÎ™Î‘</button>
                <button class="section-tab" onclick="switchTheorySection(2)">âš–ï¸ Î— Î ÎŸÎ›Î™Î¤Î™ÎšÎ—</button>
            </div>

            <div id="theoryContent"></div>
        </div>

        <!-- VISUAL TAB -->
        <div id="visualTab" class="card hidden">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <h2 style="margin: 0;">ğŸ–¼ï¸ ÎŸÎ Î¤Î™ÎšÎŸ Î¥Î›Î™ÎšÎŸ</h2>
                <div>Î•Î¹ÎºÏŒÎ½Î± <span id="imageNumber">1</span>/4</div>
            </div>
            <div id="visualContent"></div>
        </div>

        <!-- EXERCISES TAB -->
        <div id="exercisesTab" class="hidden">
            <div class="exercise-numbers" id="exerciseNumbers"></div>
            <div class="card" id="exerciseContent"></div>
        </div>

        <!-- QUIZ TAB -->
        <div id="quizTab" class="hidden">
            <div id="quizContent"></div>
        </div>
    </div>

    <!-- GLOSSARY MODAL -->
    <div id="glossaryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“– Î“Î›Î©Î£Î£Î‘Î¡Î™ÎŸ</h2>
                <button class="close-btn" onclick="toggleGlossary()">âœ•</button>
            </div>
            <div id="glossaryContent"></div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <p>ğŸ“š Î Î·Î³Î®: Î‘. ÎœÎ±ÏƒÏ„ÏÎ±Ï€Î¬, Î™ÏƒÏ„Î¿ÏÎ¯Î± Ï„Î¿Ï… Î‘ÏÏ‡Î±Î¯Î¿Ï… ÎšÏŒÏƒÎ¼Î¿Ï…</p>
        <p style="opacity: 0.8;">Â© 2025 | Î”Î¹Î±Î´ÏÎ±ÏƒÏ„Î¹ÎºÎ® Î•Ï†Î±ÏÎ¼Î¿Î³Î® Î‘ÏÏ‡Î±Î¯Î± Î‘Î¯Î³Ï…Ï€Ï„Î¿Ï‚</p>
    </footer>

    <script>
        // STATE
        let state = {
            activeTab: 'theory',
            currentTheorySection: 0,
            currentImage: 0,
            currentExercise: 0,
            points: 0,
            completedSections: {
                theory: false,
                visual: false,
                exercises: false
            },
            answers: {},
            showResults: {},
            highlightedKeywords: [],
            quizActive: false,
            quizAnswers: [],
            quizComplete: false,
            pyramidSlots: [null, null, null, null, null],
            draggedItem: null
        };

        // DATA
        const glossary = [
            { term: 'Î˜Î•ÎŸÎšÎ¡Î‘Î¤Î™ÎšÎŸ', def: 'ÎšÏÎ¬Ï„Î¿Ï‚ ÏŒÏ€Î¿Ï… Î· ÎµÎ¾Î¿Ï…ÏƒÎ¯Î± Ï€ÏÎ¿Î­ÏÏ‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î¸ÎµÏŠÎºÎ® Î¸Î­Î»Î·ÏƒÎ·', icon: 'ğŸ‘‘' },
            { term: 'Î Î›Î•ÎŸÎÎ‘Î£ÎœÎ‘', def: 'Î— Ï€ÎµÏÎ¯ÏƒÏƒÎµÎ¹Î± Ï€Î±ÏÎ±Î³Ï‰Î³Î®Ï‚', icon: 'ğŸ“¦' },
            { term: 'Î¤Î‘Î¡Î™Î§Î•Î¥Î£Î—', def: 'Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ· ÏƒÏÎ¼Î±Ï„Î¿Ï‚ Î½ÎµÎºÏÎ¿Ï', icon: 'ğŸº' },
            { term: 'ÎœÎÎ—ÎœÎ•Î™Î‘ÎšÎŸÎ£', def: 'ÎœÎµÎ³Î¬Î»ÎµÏ‚ Î´Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚', icon: 'ğŸ›ï¸' },
            { term: 'Î—Î›Î•ÎšÎ¤Î¡ÎŸ', def: 'ÎšÏÎ¬Î¼Î± Ï‡ÏÏ…ÏƒÎ¿Ï ÎºÎ±Î¹ Î±ÏÎ³ÏÏÎ¿Ï…', icon: 'âœ¨' }
        ];

        const visualContent = {
            images: [
                { id: 1, title: 'Î¤Î¿Î¹Ï‡Î¿Î³ÏÎ±Ï†Î¯Î± Î˜ÎµÏÎ¹ÏƒÎ¼Î¿Ï', emoji: 'ğŸŒ¾', desc: 'Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î¸ÎµÏÎ¹ÏƒÎ¼Î¿Ï Î±Ï€ÏŒ Ï„Î¬Ï†Î¿ Î˜Î®Î²Î±Ï‚' },
                { id: 2, title: 'ÎÏÎ»Î¹Î½Î± ÎŸÎ¼Î¿Î¹ÏÎ¼Î±Ï„Î±', emoji: 'ğŸº', desc: 'ÎŸÎ¼Î¿Î¯Ï‰Î¼Î± Î³ÎµÏ‰ÏÎ³Î¿Ï ÎºÎ±Î¹ ÏƒÎ¹Ï„Î±Ï€Î¿Î¸Î®ÎºÎ·' },
                { id: 3, title: 'ÎšÏ…Î½Î®Î³Î¹ ÏƒÏ„Î± ÎˆÎ»Î·', emoji: 'ğŸ¦†', desc: 'ÎšÏ…Î½Î®Î³Î¹ Î¼Îµ Î³Î¬Ï„Î±' },
                { id: 4, title: 'Î†Î³Î±Î»Î¼Î± Î“ÏÎ±Ï†Î­Î±', emoji: 'ğŸ“œ', desc: 'Î“ÏÎ±Ï†Î­Î±Ï‚ Î‘ÏÏ‡Î±Î¯Î¿Ï… Î’Î±ÏƒÎ¹Î»ÎµÎ¯Î¿Ï…' }
            ],
            parathema: {
                text: 'ÎŸ ÎÎµÎ¯Î»Î¿Ï‚ Î´ÎµÎ½ ÎºÎ¿Î¼Î¯Î¶ÎµÎ¹ Î¼ÏŒÎ½Î¿Î½ Ï„Î¿ Î½ÎµÏÏŒ. Î— Ï€Î»Î·Î¼Î¼ÏÏÎ± Ï†Ï„Î¬Î½ÎµÎ¹ Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½Î· Î¼Îµ Î»Î¬ÏƒÏ€Î· Ï€Î¿Ï… Î±Ï€Î¿ÏƒÏ€Î¬Ï„Î±Î¹ ÎºÏ…ÏÎ¯Ï‰Ï‚ Î±Ï€ÏŒ Ï„Î± Î·Ï†Î±Î¹ÏƒÏ„ÎµÎ¹Î¿Î³ÎµÎ½Î® Ï‡ÏÎ¼Î±Ï„Î± Ï„Î·Ï‚ Î†Î½Ï‰ Î‘Î²Ï…ÏƒÏƒÎ·Î½Î¯Î±Ï‚. ÎšÎ±Ï„Î±Î»Î±Î²Î±Î¯Î½Î¿Ï…Î¼Îµ Ï„Î¿ Î³Î¹Î±Ï„Î¯ Î¿Î¹ Î‘Î¹Î³ÏÏ€Ï„Î¹Î¿Î¹, Î²Î»Î­Ï€Î¿Î½Ï„Î±Ï‚ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€Î»Î·Î¼Î¼ÏÏÎ±, Ï€Î¿Ï… Ï„Î¿Ï…Ï‚ Ï†Î­ÏÎ½ÎµÎ¹ ÏƒÏ…Î³Ï‡ÏÏŒÎ½Ï‰Ï‚ Î½ÎµÏÏŒ ÎºÎ±Î¹ Ï‡ÏÎ¼Î±, Ï„Î·Î½ Î­ÎºÎ±Î½Î±Î½ Î¸ÎµÏŒ, Ï„Î¿Î½ Î§Î±Ï€Î¯...',
                keywords: ['Î½ÎµÏÏŒ', 'Î»Î¬ÏƒÏ€Î·', 'Î¸ÎµÏŒÏ‚ Î§Î±Ï€Î¯', 'Ï€Î»Î·Î¼Î¼ÏÏÎ±']
            }
        };

        const exercises = [
            {
                id: 1,
                type: 'multiple',
                question: 'Î Î¿Î¹Î± Î®Ï„Î±Î½ Î· Î²Î¬ÏƒÎ· Ï„Î·Ï‚ Î±Î¹Î³Ï…Ï€Ï„Î¹Î±ÎºÎ®Ï‚ Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¯Î±Ï‚;',
                options: ['Î¤Î¿ ÎµÎ¼Ï€ÏŒÏÎ¹Î¿', 'Î— Î³ÎµÏ‰ÏÎ³Î¯Î±', 'Î— Î²Î¹Î¿Ï„ÎµÏ‡Î½Î¯Î±', 'ÎŸ Ï€ÏŒÎ»ÎµÎ¼Î¿Ï‚'],
                correct: 1,
                points: 10
            },
            {
                id: 2,
                type: 'pyramid',
                question: 'Î¤Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎµ Ï„Î¹Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ ÏƒÏ„Î·Î½ Ï€Ï…ÏÎ±Î¼Î¯Î´Î±:',
                items: ['Î¦Î±ÏÎ±Ï', 'Î™ÎµÏÎµÎ¯Ï‚', 'Î“ÏÎ±Ï†ÎµÎ¯Ï‚', 'Î•Î»ÎµÏÎ¸ÎµÏÎ¿Î¹', 'Î”Î¿ÏÎ»Î¿Î¹'],
                points: 15
            },
            {
                id: 3,
                type: 'truefalse',
                questions: [
                    { text: 'ÎŸ Ï†Î±ÏÎ±Ï Î¸ÎµÏ‰ÏÎ¿ÏÎ½Ï„Î±Î½ Î¸ÎµÏŒÏ‚ ÏƒÏ„Î· Î³Î·', correct: true },
                    { text: 'ÎŸÎ¹ Î´Î¿ÏÎ»Î¿Î¹ Î®Ï„Î±Î½ Ï€Î»ÎµÎ¹Î¿ÏˆÎ·Ï†Î¯Î±', correct: false },
                    { text: 'Î— Î²Î¹Î¿Ï„ÎµÏ‡Î½Î¯Î± ÎµÎ»ÎµÎ³Ï‡ÏŒÏ„Î±Î½ Î±Ï€ÏŒ Ï„Î¿ ÎºÏÎ¬Ï„Î¿Ï‚', correct: true }
                ],
                points: 10
            }
        ];

        const finalQuiz = [
            { q: 'Î Î¿Î¹Î¿Ï‚ Ï€Î¿Ï„Î±Î¼ÏŒÏ‚ Î®Ï„Î±Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÏŒÏ‚;', opts: ['Î•Ï…Ï†ÏÎ¬Ï„Î·Ï‚', 'ÎÎµÎ¯Î»Î¿Ï‚', 'Î¤Î¯Î³ÏÎ·Ï‚', 'Î™Î¿ÏÎ´Î¬Î½Î·Ï‚'], correct: 1 },
            { q: 'Î Î¿Î¹Î¿Ï‚ ÏƒÏ„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® Ï„Î·Ï‚ Ï€Ï…ÏÎ±Î¼Î¯Î´Î±Ï‚;', opts: ['Î™ÎµÏÎµÎ¯Ï‚', 'Î¦Î±ÏÎ±Ï', 'Î“ÏÎ±Ï†ÎµÎ¯Ï‚', 'Î£Ï„ÏÎ±Ï„Î¹Ï‰Ï„Î¹ÎºÎ¿Î¯'], correct: 1 },
            { q: 'Î¤Î¹ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎ± ÎµÎ¯Ï‡Îµ Î· Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®;', opts: ['Î”Î·Î¼Î¿ÎºÏÎ±Ï„Î¹ÎºÏŒ', 'ÎŸÎ»Î¹Î³Î±ÏÏ‡Î¹ÎºÏŒ', 'Î˜ÎµÎ¿ÎºÏÎ±Ï„Î¹ÎºÏŒ', 'Î¤Ï…ÏÎ±Î½Î½Î¹ÎºÏŒ'], correct: 2 },
            { q: 'Î¤Î¹ Î­Ï†ÎµÏÎ½Î±Î½ Î¿Î¹ Ï€Î»Î·Î¼Î¼ÏÏÎµÏ‚;', opts: ['Î›Î¬ÏƒÏ€Î·', 'Î¨Î¬ÏÎ¹Î±', 'Î§ÏÏ…ÏƒÏŒ', 'ÎÏ…Î»ÎµÎ¯Î±'], correct: 0 },
            { q: 'Î Î¿Î¹Î¿Î¹ Î®Ï„Î±Î½ Ï€Î»ÎµÎ¹Î¿ÏˆÎ·Ï†Î¯Î±;', opts: ['Î”Î¿ÏÎ»Î¿Î¹', 'Î™ÎµÏÎµÎ¯Ï‚', 'Î•Î»ÎµÏÎ¸ÎµÏÎ¿Î¹', 'Î£Ï„ÏÎ±Ï„Î¹Ï‰Ï„Î¹ÎºÎ¿Î¯'], correct: 2 }
        ];

        // INIT
        function init() {
            renderGlossary();
            renderTheorySection();
            renderExerciseNumbers();
            updatePoints();
            updateProgress();
        }

        // GLOSSARY
        function renderGlossary() {
            const content = glossary.map(g => `
                <div class="glossary-item">
                    <div class="glossary-term-header">
                        <span class="glossary-icon">${g.icon}</span>
                        <strong class="glossary-term">${g.term}</strong>
                    </div>
                    <p class="glossary-def">${g.def}</p>
                </div>
            `).join('');
            document.getElementById('glossaryContent').innerHTML = content;
        }

        function toggleGlossary() {
            document.getElementById('glossaryModal').classList.toggle('show');
        }

        // NAVIGATION
        function switchTab(tab) {
            if (tab === 'visual' && !state.completedSections.theory) return;
            if (tab === 'exercises' && !state.completedSections.visual) return;

            state.activeTab = tab;

            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('theoryTab').classList.add('hidden');
            document.getElementById('visualTab').classList.add('hidden');
            document.getElementById('exercisesTab').classList.add('hidden');
            document.getElementById('quizTab').classList.add('hidden');

            if (tab === 'theory') {
                document.getElementById('navTheory').classList.add('active');
                document.getElementById('theoryTab').classList.remove('hidden');
            } else if (tab === 'visual') {
                document.getElementById('navVisual').classList.add('active');
                document.getElementById('visualTab').classList.remove('hidden');
                renderVisual();
            } else if (tab === 'exercises') {
                document.getElementById('navExercises').classList.add('active');
                document.getElementById('exercisesTab').classList.remove('hidden');
                renderExercise();
            }
        }

        // THEORY
        function switchTheorySection(section) {
            state.currentTheorySection = section;
            renderTheorySection();
            
            document.querySelectorAll('.section-tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === section);
            });
        }

        function renderTheorySection() {
            const sections = [
                {
                    title: 'ğŸŒ¾ Î— ÎŸÎ™ÎšÎŸÎÎŸÎœÎ™Î‘',
                    subsections: [
                        {
                            title: 'ğŸï¸ ÎŸ Î¡ÎŸÎ›ÎŸÎ£ Î¤ÎŸÎ¥ ÎÎ•Î™Î›ÎŸÎ¥',
                            points: [
                                'Î Î»Î·Î¼Î¼ÏÏÎµÏ‚ ÎºÎ¬Î¸Îµ ÎºÎ±Î»Î¿ÎºÎ±Î¯ÏÎ¹',
                                'Î›Î¹Ï€Î±Î¯Î½Î¿Ï…Î½ Ï„Î· Î³Î· Î¼Îµ Î»Î¬ÏƒÏ€Î·',
                                'Î†ÏÎ´ÎµÏ…ÏƒÎ· = ÏƒÏ…Î»Î»Î¿Î³Î¹ÎºÎ® ÎµÏÎ³Î±ÏƒÎ¯Î±',
                                'Î•Ï€Î¯Î²Î»ÎµÏˆÎ· Î±Ï€ÏŒ Ï„Î¿ ÎºÏÎ¬Ï„Î¿Ï‚'
                            ]
                        },
                        {
                            title: 'ğŸŒ± Î“Î•Î©Î¡Î“Î™Î‘ (Î’Î¬ÏƒÎ· Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¯Î±Ï‚)',
                            content: [
                                { label: 'Î£Î¹Ï„Î¬ÏÎ¹', icon: 'ğŸŒ¾' },
                                { label: 'ÎšÏÎ¹Î¸Î¬ÏÎ¹', icon: 'ğŸŒ¾' },
                                { label: 'Î›Î¹Î½Î¬ÏÎ¹', icon: 'ğŸŒ¿' },
                                { label: 'ÎšÎ·Ï€ÎµÏ…Ï„Î¹ÎºÎ¬', icon: 'ğŸ¥¬' },
                                { label: 'ÎŸÏ€Ï‰ÏÎ¿Ï†ÏŒÏÎ±', icon: 'ğŸ' },
                                { label: 'Î Î¬Ï€Ï…ÏÎ¿Ï‚', icon: 'ğŸ“œ' }
                            ]
                        },
                        {
                            title: 'ğŸ­ Î’Î™ÎŸÎ¤Î•Î§ÎÎ™Î‘ & Î•ÎœÎ ÎŸÎ¡Î™ÎŸ',
                            points: [
                                'Î¤ÎµÏ‡Î½Î¯Ï„ÎµÏ‚: Î¼ÎµÏ„Î±Î»Î»Î¿Ï…ÏÎ³Î¿Î¯, ÎºÎµÏÎ±Î¼Î¿Ï€Î¿Î¹Î¿Î¯, Î¾Ï…Î»Î¿Ï…ÏÎ³Î¿Î¯',
                                'âš ï¸ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Ï€ÏŒ Ï„Î¿ ÎºÏÎ¬Ï„Î¿Ï‚ (Ï†Î±ÏÎ±Ï)',
                                'Î•Î¾Î±Î³Ï‰Î³Î­Ï‚: Î´Î·Î¼Î·Ï„ÏÎ¹Î±ÎºÎ¬, Ï€Î¬Ï€Ï…ÏÎ¿Ï‚, Ï‡ÏÏ…ÏƒÏŒÏ‚',
                                'Î•Î¹ÏƒÎ±Î³Ï‰Î³Î­Ï‚: Î¾Ï…Î»ÎµÎ¯Î±, Ï‡Î±Î»ÎºÏŒÏ‚, Î¬ÏÎ³Ï…ÏÎ¿Ï‚'
                            ]
                        }
                    ]
                },
                {
                    title: 'ğŸ‘¥ Î— ÎšÎŸÎ™ÎÎ©ÎÎ™Î‘',
                    pyramid: [
                        { name: 'Î¦Î‘Î¡Î‘Î©', desc: 'Î˜ÎµÏŒÏ‚ ÏƒÏ„Î· Î³Î·', width: 20 },
                        { name: 'Î™Î•Î¡Î•Î™Î£ & Î¥Î Î‘Î›Î›Î—Î›ÎŸÎ™', desc: 'Î™ÏƒÏ‡Ï…ÏÎ¿Î¯', width: 35 },
                        { name: 'Î“Î¡Î‘Î¦Î•Î™Î£ & Î£Î¤Î¡Î‘Î¤Î™Î©Î¤Î™ÎšÎŸÎ™', desc: 'ÎœÎ¿ÏÏ†Ï‰Î¼Î­Î½Î¿Î¹', width: 50 },
                        { name: 'Î•Î›Î•Î¥Î˜Î•Î¡ÎŸÎ™ Î ÎŸÎ›Î™Î¤Î•Î£', desc: 'Î Î»ÎµÎ¹Î¿ÏˆÎ·Ï†Î¯Î±', width: 70 },
                        { name: 'Î”ÎŸÎ¥Î›ÎŸÎ™', desc: 'Î™Î´Î¹Ï‰Ï„Î¹ÎºÎ¿Î¯ & ÎšÏÎ±Ï„Î¹ÎºÎ¿Î¯', width: 90 }
                    ]
                },
                {
                    title: 'âš–ï¸ Î— Î ÎŸÎ›Î™Î¤Î™ÎšÎ—',
                    hierarchy: [
                        { title: 'Î¦Î‘Î¡Î‘Î©', icon: 'ğŸ‘‘', points: ['Î‘Ï€ÏŒÎ»Ï…Ï„Î· ÎµÎ¾Î¿Ï…ÏƒÎ¯Î±', 'Î˜Î­Î»Î·ÏƒÎ® Ï„Î¿Ï… = ÎÏŒÎ¼Î¿Ï‚'] },
                        { title: 'ÎšÎ¡Î‘Î¤Î™ÎšÎ— ÎœÎ—Î§Î‘ÎÎ—', icon: 'ğŸ›ï¸', points: ['Î™ÎµÏÎµÎ¯Ï‚', 'Î¥Ï€Î¬Î»Î»Î·Î»Î¿Î¹', 'Î“ÏÎ±Ï†ÎµÎ¯Ï‚'] },
                        { title: 'Î›Î‘ÎŸÎ£', icon: 'ğŸ‘¥', points: ['Î¥Ï€Î±ÎºÎ¿Î® & Î•ÏÎ³Î±ÏƒÎ¯Î±'] }
                    ]
                }
            ];

            const section = sections[state.currentTheorySection];
            let html = `<h2>${section.title}</h2>`;

            if (section.subsections) {
                section.subsections.forEach(sub => {
                    html += `<div class="subsection"><h3>${sub.title}</h3>`;
                    if (sub.content) {
                        html += '<div class="grid-3">';
                        sub.content.forEach(item => {
                            html += `
                                <div class="grid-item">
                                    <div class="grid-item-icon">${item.icon}</div>
                                    <div class="grid-item-label">${item.label}</div>
                                </div>
                            `;
                        });
                        html += '</div>';
                    } else if (sub.points) {
                        html += '<ul>';
                        sub.points.forEach(p => html += `<li>${p}</li>`);
                        html += '</ul>';
                    }
                    html += '</div>';
                });
            }

            if (section.pyramid) {
                html += '<div class="pyramid"><h3>ğŸ”º ÎšÎŸÎ™ÎÎ©ÎÎ™ÎšÎ— Î Î¥Î¡Î‘ÎœÎ™Î”Î‘</h3><div class="pyramid-levels">';
                section.pyramid.forEach(lvl => {
                    html += `
                        <div class="pyramid-level" style="width: ${lvl.width}%;">
                            <div class="pyramid-level-name">${lvl.name}</div>
                            <div class="pyramid-level-desc">${lvl.desc}</div>
                        </div>
                    `;
                });
                html += '</div><div class="info-box">â„¹ï¸ ÎšÎ¿Î¹Î½Ï‰Î½Î¹ÎºÎ® ÎµÏ…ÎµÎ»Î¹Î¾Î¯Î± ÏƒÏ„Î¿ ÎÎ­Î¿ Î’Î±ÏƒÎ¯Î»ÎµÎ¹Î¿!</div></div>';
            }

            if (section.hierarchy) {
                html += '<div class="pyramid"><h3>ğŸ›ï¸ Î˜Î•ÎŸÎšÎ¡Î‘Î¤Î™ÎšÎŸ ÎšÎ¡Î‘Î¤ÎŸÎ£</h3><div class="hierarchy">';
                section.hierarchy.forEach((h, i) => {
                    html += `
                        <div>
                            <div class="hierarchy-box">
                                <div class="hierarchy-icon">${h.icon}</div>
                                <h4 class="hierarchy-title">${h.title}</h4>
                                <ul class="hierarchy-points">
                                    ${h.points.map(p => `<li>â€¢ ${p}</li>`).join('')}
                                </ul>
                            </div>
                            ${i < section.hierarchy.length - 1 ? '<div class="hierarchy-arrow">â†“</div>' : ''}
                        </div>
                    `;
                });
                html += '</div><div class="definition-box">ğŸ“Œ Î˜ÎµÎ¿ÎºÏÎ±Ï„Î¹ÎºÏŒ = ÎµÎ¾Î¿Ï…ÏƒÎ¯Î± Î±Ï€ÏŒ Î¸ÎµÏŒ</div></div>';
            }

            html += `
                <div class="button-group">
                    <button class="btn btn-prev" ${state.currentTheorySection === 0 ? 'disabled' : ''} 
                        onclick="switchTheorySection(${state.currentTheorySection - 1})">â† Î ÏÎ¿Î·Î³.</button>
                    <button class="btn btn-next" onclick="handleNextTheory()">
                        ${state.currentTheorySection === 2 ? 'ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·' : 'Î•Ï€ÏŒÎ¼ÎµÎ½Î¿'} â†’
                    </button>
                </div>
            `;

            if (state.currentTheorySection === 2) {
                html += `
                    <div class="success-box" id="theorySuccess" style="display: none;">
                        <p>âœ… ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎµÏ‚ Ï„Î· Î˜ÎµÏ‰ÏÎ¯Î±! (+20 Ï€ÏŒÎ½Ï„Î¿Î¹ ğŸ”º)</p>
                        <button class="continue-btn" onclick="completeTheory()">Î£Ï…Î½Î­Ï‡ÎµÎ¹Î± ÏƒÏ„Î¿ ÎŸÏ€Ï„Î¹ÎºÏŒ â†’</button>
                    </div>
                `;
            }

            document.getElementById('theoryContent').innerHTML = html;
        }

        function handleNextTheory() {
            if (state.currentTheorySection < 2) {
                addPoints(10);
                switchTheorySection(state.currentTheorySection + 1);
            } else {
                document.getElementById('theorySuccess').style.display = 'block';
            }
        }

        function completeTheory() {
            state.completedSections.theory = true;
            addPoints(20);
            document.getElementById('navVisual').classList.remove('locked');
            document.getElementById('navVisual').innerHTML = 'ğŸ–¼ï¸ ÎŸÎ Î¤Î™ÎšÎŸ';
            updateProgress();
            switchTab('visual');
        }

        // VISUAL
        function renderVisual() {
            const img = visualContent.images[state.currentImage];
            let html = `
                <div class="image-card">
                    <div class="image-emoji">${img.emoji}</div>
                    <h3 class="image-title">${img.title}</h3>
                    <p class="image-desc">${img.desc}</p>
                </div>
                <div class="button-group">
                    <button class="btn btn-prev" ${state.currentImage === 0 ? 'disabled' : ''} 
                        onclick="prevImage()">â† Î ÏÎ¿Î·Î³.</button>
                    <button class="btn btn-next" ${state.currentImage === 3 ? 'disabled' : ''} 
                        onclick="nextImage()">Î•Ï€ÏŒÎ¼. â†’</button>
                </div>
            `;

            if (state.currentImage === 3) {
                html += `
                    <div class="parathema-box">
                        <h3>ğŸ“œ Jean Vercoutter</h3>
                        <h4 style="font-style: italic; color: #666;">"Î— ÏƒÎ·Î¼Î±ÏƒÎ¯Î± Ï„Î¿Ï… ÎÎµÎ¯Î»Î¿Ï…"</h4>
                        <div class="parathema-text">${visualContent.parathema.text}</div>
                        <h4>ğŸ¯ Î•Î¡Î©Î¤Î—Î£Î•Î™Î£:</h4>
                        <div class="keywords-box">
                            <p style="font-weight: bold;">Î’ÏÎµÏ‚ Ï„Î¹Ï‚ Î»Î­Î¾ÎµÎ¹Ï‚-ÎºÎ»ÎµÎ¹Î´Î¹Î¬:</p>
                            <div class="keywords-flex" id="keywordsContainer">
                                ${visualContent.parathema.keywords.map((kw, i) => `
                                    <button class="keyword-btn" onclick="toggleKeyword(${i})">${kw}</button>
                                `).join('')}
                            </div>
                            <div style="font-size: 12px; color: #666; margin-top: 10px;">
                                (+<span id="keywordPoints">0</span> Ï€ÏŒÎ½Ï„Î¿Î¹)
                            </div>
                        </div>
                        <div class="success-box" style="margin-top: 20px;">
                            <p>âœ… ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎµÏ‚ Ï„Î¿ ÎŸÏ€Ï„Î¹ÎºÏŒ! (+25 Ï€ÏŒÎ½Ï„Î¿Î¹ ğŸ”º)</p>
                            <button class="continue-btn" onclick="completeVisual()">Î£Ï…Î½Î­Ï‡ÎµÎ¹Î± ÏƒÏ„Î¹Ï‚ Î‘ÏƒÎºÎ®ÏƒÎµÎ¹Ï‚ â†’</button>
                        </div>
                    </div>
                `;
            }

            document.getElementById('visualContent').innerHTML = html;
            document.getElementById('imageNumber').textContent = state.currentImage + 1;
        }

        function prevImage() {
            if (state.currentImage > 0) {
                state.currentImage--;
                renderVisual();
            }
        }

        function nextImage() {
            if (state.currentImage < 3) {
                state.currentImage++;
                renderVisual();
            }
        }

        function toggleKeyword(index) {
            const keywordBtns = document.querySelectorAll('.keyword-btn');
            if (state.highlightedKeywords.includes(index)) {
                state.highlightedKeywords = state.highlightedKeywords.filter(i => i !== index);
                keywordBtns[index].classList.remove('highlighted');
            } else {
                state.highlightedKeywords.push(index);
                keywordBtns[index].classList.add('highlighted');
                addPoints(2);
            }
            document.getElementById('keywordPoints').textContent = state.highlightedKeywords.length * 2;
        }

        function completeVisual() {
            state.completedSections.visual = true;
            addPoints(25);
            document.getElementById('navExercises').classList.remove('locked');
            document.getElementById('navExercises').innerHTML = 'âœï¸ Î‘Î£ÎšÎ—Î£Î•Î™Î£';
            updateProgress();
            switchTab('exercises');
        }

        // EXERCISES
        function renderExerciseNumbers() {
            const html = exercises.map((ex, i) => `
                <button class="exercise-number ${i === state.currentExercise ? 'active' : ''} ${state.showResults[ex.id] ? 'completed' : ''}" 
                    onclick="switchExercise(${i})">${i + 1}</button>
            `).join('');
            document.getElementById('exerciseNumbers').innerHTML = html;
        }

        function switchExercise(index) {
            state.currentExercise = index;
            renderExerciseNumbers();
            renderExercise();
        }

        function renderExercise() {
            const ex = exercises[state.currentExercise];
            let html = `
                <span class="exercise-tag">Î‘Î£ÎšÎ—Î£Î— ${ex.id} | ${ex.points} Î ÏŒÎ½Ï„Î¿Î¹</span>
                <p class="question">â“ ${ex.question}</p>
            `;

            if (ex.type === 'multiple') {
                html += '<div class="options">';
                ex.options.forEach((opt, i) => {
                    const selected = state.answers[ex.id] === i;
                    const showResult = state.showResults[ex.id];
                    const correct = i === ex.correct;
                    const wrong = selected && !correct;
                    
                    html += `
                        <button class="option-btn ${selected ? 'selected' : ''} ${showResult && correct ? 'correct' : ''} ${showResult && wrong ? 'wrong' : ''}"
                            onclick="selectAnswer(${ex.id}, ${i})">
                            ${['A', 'B', 'Î“', 'Î”'][i]}. ${opt}
                        </button>
                    `;
                });
                html += '</div>';

                if (!state.showResults[ex.id]) {
                    html += `<button class="submit-btn" ${state.answers[ex.id] === undefined ? 'disabled' : ''} 
                        onclick="checkAnswer(${ex.id})">Î¥Ï€Î¿Î²Î¿Î»Î®</button>`;
                } else {
                    const correct = state.answers[ex.id] === ex.correct;
                    html += `
                        <div class="result-box ${correct ? 'correct' : 'incorrect'}">
                            <p style="margin: 0; font-weight: bold;">
                                ${correct ? `âœ“ Î£Î©Î£Î¤ÎŸ! (+${ex.points} Ï€ÏŒÎ½Ï„Î¿Î¹ ğŸ”º)` : 'âœ— Î›Î¬Î¸Î¿Ï‚!'}
                            </p>
                        </div>
                    `;
                }
            } else if (ex.type === 'pyramid') {
                html += '<div class="pyramid-drag"><div class="pyramid-drag-levels">';
                [20, 35, 50, 70, 90].forEach((w, i) => {
                    html += `
                        <div class="pyramid-slot ${state.pyramidSlots[i] ? 'filled' : ''}" 
                            style="width: ${w}%;" 
                            ondrop="drop(event, ${i})" 
                            ondragover="allowDrop(event)">
                            ${state.pyramidSlots[i] || `Î˜Î­ÏƒÎ· ${i + 1}`}
                        </div>
                    `;
                });
                html += '</div></div>';

                html += '<div class="drag-items-box"><p style="font-weight: bold; margin-bottom: 10px;">ğŸ“¦ Î£ÏÏÎµ:</p><div class="drag-items-flex">';
                ex.items.forEach((item, i) => {
                    if (!state.pyramidSlots.includes(item)) {
                        html += `<div class="drag-item" draggable="true" ondragstart="drag(event, ${i})">${item}</div>`;
                    }
                });
                html += '</div></div>';

                html += `
                    <div class="button-group">
                        <button class="btn btn-next" ${state.pyramidSlots.includes(null) ? 'disabled' : ''} 
                            onclick="checkPyramid()">ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚</button>
                        <button class="btn" onclick="resetPyramid()" style="background-color: white; border: 2px solid #ddd; color: #2C3E50;">Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬</button>
                    </div>
                `;

                if (state.showResults[ex.id]) {
                    const correct = state.pyramidSlots.every((s, i) => s === ex.items[i]);
                    html += `
                        <div class="result-box ${correct ? 'correct' : 'incorrect'}">
                            <p style="margin: 0; font-weight: bold;">
                                ${correct ? `âœ“ Î£Î©Î£Î¤ÎŸ! (+${ex.points} Ï€ÏŒÎ½Ï„Î¿Î¹ ğŸ”º)` : 'âœ— ÎÎ±Î½Î¬!'}
                            </p>
                        </div>
                    `;
                }
            } else if (ex.type === 'truefalse') {
                ex.questions.forEach((q, i) => {
                    const answer = state.answers[ex.id] ? state.answers[ex.id][i] : undefined;
                    const showResult = state.showResults[ex.id];
                    
                    html += `
                        <div class="truefalse-question">
                            <p class="truefalse-text">${q.text}</p>
                            <div class="truefalse-buttons">
                                <button class="truefalse-btn ${answer === true ? 'selected' : ''} ${showResult && q.correct ? 'correct-answer' : ''}"
                                    onclick="selectTrueFalse(${ex.id}, ${i}, true)">Î£Ï‰ÏƒÏ„ÏŒ âœ“</button>
                                <button class="truefalse-btn ${answer === false ? 'selected' : ''} ${showResult && !q.correct ? 'correct-answer' : ''}"
                                    onclick="selectTrueFalse(${ex.id}, ${i}, false)">Î›Î¬Î¸Î¿Ï‚ âœ—</button>
                            </div>
                        </div>
                    `;
                });

                if (!state.showResults[ex.id]) {
                    const allAnswered = state.answers[ex.id] && state.answers[ex.id].length === ex.questions.length;
                    html += `<button class="submit-btn" ${!allAnswered ? 'disabled' : ''} 
                        onclick="checkTrueFalse(${ex.id})">Î¥Ï€Î¿Î²Î¿Î»Î®</button>`;
                }
            }

            html += `
                <div class="button-group" style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee;">
                    <button class="btn btn-prev" ${state.currentExercise === 0 ? 'disabled' : ''} 
                        onclick="switchExercise(${state.currentExercise - 1})">â† Î ÏÎ¿Î·Î³.</button>
                    ${state.currentExercise === exercises.length - 1 
                        ? '<button class="btn" style="background-color: #FFD700; color: #2C3E50;" onclick="startQuiz()">ğŸ† Î¤ÎµÎ»Î¹ÎºÏŒ Quiz</button>'
                        : `<button class="btn btn-next" onclick="switchExercise(${state.currentExercise + 1})">Î•Ï€ÏŒÎ¼. â†’</button>`
                    }
                </div>
            `;

            document.getElementById('exerciseContent').innerHTML = html;
        }

        function selectAnswer(exId, optionIndex) {
            if (!state.showResults[exId]) {
                state.answers[exId] = optionIndex;
                renderExercise();
            }
        }

        function checkAnswer(exId) {
            const ex = exercises.find(e => e.id === exId);
            state.showResults[exId] = true;
            if (state.answers[exId] === ex.correct) {
                addPoints(ex.points);
            }
            renderExerciseNumbers();
            renderExercise();
        }

        function selectTrueFalse(exId, questionIndex, answer) {
            if (!state.showResults[exId]) {
                if (!state.answers[exId]) state.answers[exId] = [];
                state.answers[exId][questionIndex] = answer;
                renderExercise();
            }
        }

        function checkTrueFalse(exId) {
            const ex = exercises.find(e => e.id === exId);
            state.showResults[exId] = true;
            const allCorrect = ex.questions.every((q, i) => state.answers[exId][i] === q.correct);
            if (allCorrect) {
                addPoints(ex.points);
            }
            renderExerciseNumbers();
            renderExercise();
        }

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev, index) {
            state.draggedItem = index;
        }

        function drop(ev, slotIndex) {
            ev.preventDefault();
            if (state.draggedItem !== null) {
                state.pyramidSlots[slotIndex] = exercises[1].items[state.draggedItem];
                state.draggedItem = null;
                renderExercise();
            }
        }

        function resetPyramid() {
            state.pyramidSlots = [null, null, null, null, null];
            renderExercise();
        }

        function checkPyramid() {
            const ex = exercises[1];
            state.showResults[ex.id] = true;
            const correct = state.pyramidSlots.every((s, i) => s === ex.items[i]);
            if (correct) {
                addPoints(ex.points);
            }
            renderExerciseNumbers();
            renderExercise();
        }

        // QUIZ
        function startQuiz() {
            state.quizActive = true;
            state.quizAnswers = [];
            state.quizComplete = false;
            state.completedSections.exercises = true;
            updateProgress();
            
            document.getElementById('exercisesTab').classList.add('hidden');
            document.getElementById('quizTab').classList.remove('hidden');
            renderQuiz();
        }

        function renderQuiz() {
            if (state.quizComplete) {
                const correct = finalQuiz.filter((q, i) => state.quizAnswers[i] === q.correct).length;
                const score = Math.round((correct / finalQuiz.length) * 100);
                
                const html = `
                    <div class="quiz-container">
                        <div class="quiz-emoji">ğŸŠ</div>
                        <h2>Î£Î¥Î“Î§Î‘Î¡Î—Î¤Î—Î¡Î™Î‘!</h2>
                        <div class="quiz-score-box">
                            <div class="quiz-score">â­ ${score}/100 â­</div>
                            <p class="quiz-details">Î£Ï‰ÏƒÏ„Î­Ï‚: ${correct}/${finalQuiz.length}</p>
                            <p class="quiz-details">Î ÏŒÎ½Ï„Î¿Î¹: ğŸ”º ${state.points}</p>
                        </div>
                        <button class="continue-btn" onclick="resetApp()">ğŸ“š Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·</button>
                    </div>
                `;
                document.getElementById('quizContent').innerHTML = html;
            } else {
                let html = '<div class="quiz-question-card"><h3>ğŸ¯ Î¤Î•Î›Î™ÎšÎŸ QUIZ</h3>';
                
                finalQuiz.forEach((q, qIdx) => {
                    html += `
                        <div style="margin-bottom: 25px;">
                            <p style="font-weight: bold; margin-bottom: 10px;">${qIdx + 1}. ${q.q}</p>
                            <div class="options">
                                ${q.opts.map((opt, oIdx) => {
                                    const selected = state.quizAnswers[qIdx] === oIdx;
                                    return `
                                        <button class="option-btn ${selected ? 'selected' : ''}"
                                            onclick="selectQuizAnswer(${qIdx}, ${oIdx})">
                                            ${['A', 'B', 'Î“', 'Î”'][oIdx]}. ${opt}
                                        </button>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                });

                html += `
                    <button class="submit-btn" ${state.quizAnswers.length !== finalQuiz.length ? 'disabled' : ''} 
                        onclick="submitQuiz()">ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·</button>
                    </div>
                `;
                
                document.getElementById('quizContent').innerHTML = html;
            }
        }

        function selectQuizAnswer(qIdx, oIdx) {
            state.quizAnswers[qIdx] = oIdx;
            renderQuiz();
        }

        function submitQuiz() {
            const correct = finalQuiz.filter((q, i) => state.quizAnswers[i] === q.correct).length;
            const score = Math.round((correct / finalQuiz.length) * 100);
            addPoints(score);
            state.quizComplete = true;
            renderQuiz();
        }

        function resetApp() {
            location.reload();
        }

        // UTILITIES
        function addPoints(pts) {
            state.points += pts;
            updatePoints();
        }

        function updatePoints() {
            document.getElementById('points').textContent = state.points;
        }

        function updateProgress() {
            let progress = 0;
            if (state.completedSections.theory) progress += 33;
            if (state.completedSections.visual) progress += 33;
            if (state.completedSections.exercises) progress += 34;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // INIT APP
        init();
    </script>
</body>
</html>
